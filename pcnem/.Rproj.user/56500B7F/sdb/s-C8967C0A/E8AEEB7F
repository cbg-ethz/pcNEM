{
    "collab_server" : "",
    "contents" : "load(\"/Volumes/beerenwinkel/ssumana/Documents/ETH/MasterThesis/data/singleCellFeatures/DataStorage/CriticalPval/Pway05200/BugFixed7Sep2017/Res_critPval_Pway05200_TR.Rdata\")\nres1 <- NULL\nfor(i in 1:30){\n  res1 <- rbind(res1,rbind(cbind(\"pc-NEM\",\"Pway05200\",ResRealNets[[i]]$pcNEM$typeIEst,ResRealNets[[i]]$pcNEM$typeIIEst,ResRealNets[[i]]$pcNEM_shd,ResRealNets[[i]]$pcNEM$mLL),\n                           cbind(\"NEM\",\"Pway05200\",NA,NA,ResRealNets[[i]]$rNEM_shd,ResRealNets[[i]]$rNEM$mLL)))}\n\nset.seed(456)\nrandom_nets <- NULL\nfor(i in 1:30){\n  Phi <- netList[[i]]\n  Sgenes <- colnames(Phi)\n  temp <- as(unifDAG (length(Sgenes), weighted=FALSE, wFUN=list(runif, min=0.1, max=1)),\"matrix\")\n  #randomDAG(n=length(Sgenes),prob=0.5,V=Sgenes)\n  dimnames(temp) <- list(Sgenes,Sgenes)\n  random_nets <- c(random_nets,shd(as(temp,'graphNEL'),as(Phi,\"graphNEL\")))\n}\n\nres1 <- as.data.frame(rbind(res1,\n              cbind(rep(\"random\",30),rep(\"Pway05200\",30),rep(NA,30),rep(NA,30),random_nets,rep(NA,30))))\n\ncolnames(res1) <- c(\"Model\",\"NetType\",\"TypeI\",\"TypeII\",\"SHD\",\"mll\")\n\n\nggplot(res1, aes(x=Model, y=as.numeric(as.character(SHD)))) + \n  geom_violin(aes(fill=factor(Model),colour=factor(Model)),alpha=0.5,position=position_dodge(0.9))+\n  geom_boxplot(width=0.1)+\n  ylab(\"Performance [SHD]\") +\n  xlab(\"Method\")+\n  theme_bw()+ \n  theme(panel.grid.major= element_blank(),#element_line(linetype=5),\n        panel.grid.minor = element_blank(),\n        axis.ticks.x = element_line(size = 0.5,color=\"#525252\"),\n        axis.text.y=element_text(angle=0, vjust=0.3, hjust=0.5,size=12,colour=\"#525252\"),\n        axis.text.x=element_text(angle=45, vjust=0.1, hjust=0,size=12,colour=\"#525252\"),\n        axis.title.x=element_blank(),\n        axis.title.y=element_text(angle=90, size=14,vjust=0,colour=\"#525252\"),\n        panel.border = element_rect(colour = \"gray48\"),\n        legend.position=\"none\",\n        strip.text.y=element_blank(),#element_text(angle=-90),\n        strip.text.x=element_text(angle=0,size = 12, colour = \"#525252\"),\n        strip.background = element_blank())+\n  scale_color_manual(name='method', values=c(\"#0A97AB\", \"#F2B800\",\"#BC7DAC\"),\n                     labels = c('NEM-ModuleNetwork','pc-NEM','Random network'))+\n  scale_fill_manual(name='method', values=c(\"#0A97AB\",\"#F2B800\",\"#BC7DAC\"),\n                    labels = c('NEM-ModuleNetwork','pc-NEM',\"Random network\"))\n\nggsave(\"~/Downloads/Performance_randomnetwork.pdf\",width=6,height=4)\n\n##### Noise levels ########\nres_true <- NULL\nfor(x in 1:30){\n  D <- Data[[x]]\n  D <- D[!rownames(D)%in% remove_feats,]\n  KOmap <- knockout_map[[x]]\n  Phi <- netList[[x]]\n  \n  control <- set.default.parameters(unique(colnames(D)),type=\"mLL\",pcombi = TRUE, trans.close=FALSE)\n  control$iterations = 0\n  control$map <- as.matrix(KOmap)\n  pcnem_true <- nem(D,models=list(Phi),inference=\"AdaSimAnneal\",control=control,verbose=FALSE)\n  print(shd(as(Phi,\"graphNEL\"),pcnem_true$graph))\n  res_true <- rbind(res_true,c(\"KEGG Network\",\"Pway05200\",pcnem_true$typeIEst,pcnem_true$typeIIEst,0,pcnem_true$mLL))\n}\n\ncolnames(res_true) <- c(\"Model\",\"NetType\",\"TypeI\",\"TypeII\",\"SHD\",\"mll\")\n\nres2 <- res1[1:60,]\nres2 <- as.data.frame(rbind(res2,res_true))\nres2 <- cbind(res2,c(rep(1:30,each=2),1:30))\ncolnames(res2)[7] <- \"netID\"\n\nggplot(res2, aes(x=as.numeric(as.character(SHD)), y=as.numeric(as.character(mll)))) + \n  geom_point(aes(fill=factor(Model),colour=factor(Model)),\n             alpha=0.5,position=position_dodge(0.9))+\n  xlab(\"Performance [SHD]\") +\n  ylab(\"log likelihood\")+\n  theme_bw()+ \n  theme(panel.grid.major= element_blank(),#element_line(linetype=5),\n        panel.grid.minor = element_blank(),\n        axis.ticks.x = element_line(size = 0.5,color=\"#525252\"),\n        axis.text.y=element_text(angle=0, vjust=0.3, hjust=0.5,size=12,colour=\"#525252\"),\n        axis.text.x=element_text(angle=0, vjust=0.1, hjust=0,size=12,colour=\"#525252\"),\n        axis.title.x=element_blank(),\n        axis.title.y=element_text(angle=90, size=14,vjust=0,colour=\"#525252\"),\n        panel.border = element_rect(colour = \"gray48\"),\n        legend.position=\"right\",\n        strip.text.y=element_blank(),#element_text(angle=-90),\n        strip.text.x=element_text(angle=0,size = 12, colour = \"#525252\"),\n        strip.background = element_blank())+\n  scale_color_manual(name='method', values=c(\"#0A97AB\", \"#F2B800\",\"#BC7DAC\"),\n                     labels = c('NEM-ModuleNetwork','pc-NEM','Random network'))+\n  scale_fill_manual(name='method', values=c(\"#0A97AB\",\"#F2B800\",\"#BC7DAC\"),\n                    labels = c('NEM-ModuleNetwork','pc-NEM',\"Random network\"))\n\n\nres3 <- as.data.frame(cbind(1:30,\n                            as.numeric(as.character(res1$mll[res1$Model==\"pc-NEM\"])),\n                            as.numeric(as.character(res1$mll[res1$Model==\"NEM\"])),\n                            as.numeric(as.character(res_true[,6]))))\ncolnames(res3) <- c(\"netID\",\"pcNEM\",\"NEM\",\"True\")\nggplot()+\n  geom_point(data=res3,aes(x=netID,y=pcNEM,colour=\"#F2B800\"))+\n  geom_point(data=res3,aes(x=netID,y=NEM,colour=\"#0A97AB\"))+\n  geom_point(data=res3,aes(x=netID,y=True,colour=\"#BC7DAC\"))+\n  xlab(\"Network ID\") +\n  ylab(\"log likelihood\")+\n  theme_bw()+ \n  theme(panel.grid.major= element_blank(),#element_line(linetype=5),\n        panel.grid.minor = element_blank(),\n        legend.position = \"right\")+\n  scale_color_manual(\"method\", values =c(\"#0A97AB\"=\"#0A97AB\",\"#BC7DAC\"=\"#BC7DAC\",\"#F2B800\"=\"#F2B800\"), \n                     labels=c('NEM-ModuleNetwork','KEGG network','pc-NEM'))\n  ggsave(\"~/Downloads/LogLikelihood.pdf\",width=6,height=4)\n  \n  \n  res4 <- as.data.frame(cbind(1:30,\n                            res1[res1$Model==\"pc-NEM\",3:4],\n                            res_true[,3:4]))\n  colnames(res4) <- c(\"netID\",\"pcTypeI\",\"pcTypeII\",\"TrueTypeI\",\"TrueTypeII\")\n  ggplot()+\n    geom_point(data=res4,aes(x=netID,y=as.numeric(as.character(pcTypeI)),colour=\"red1\"),alpha=0.7)+\n    geom_point(data=res4,aes(x=netID,y=as.numeric(as.character(TrueTypeI)),colour=\"olivedrab3\"),alpha=0.7)+\n    xlab(\"Network ID\") +\n    ylab(\"TypeI\")+\n    theme_bw()+ \n    theme(panel.grid.major= element_blank(),#element_line(linetype=5),\n          panel.grid.minor = element_blank(),\n          legend.position = \"right\")+\n    scale_color_manual(\"method\", values =c(\"olivedrab3\"=\"olivedrab3\",\"red1\"=\"red1\"), \n                       labels=c('KEGG network','pc-NEM'))\n  \n  \n  ggsave(\"~/Downloads/TypeICompare.pdf\",width=6,height=4)\n  \n  \n  ggplot()+\n    geom_point(data=res4,aes(x=netID,y=as.numeric(as.character(pcTypeII)),colour=\"red1\"),alpha=0.7)+\n    geom_point(data=res4,aes(x=netID,y=as.numeric(as.character(TrueTypeII)),colour=\"olivedrab3\"),alpha=0.7)+\n    xlab(\"Network ID\") +\n    ylab(\"TypeII\")+\n    theme_bw()+ \n    theme(panel.grid.major= element_blank(),#element_line(linetype=5),\n          panel.grid.minor = element_blank(),\n          legend.position = \"right\")+\n    scale_color_manual(\"method\", values =c(\"olivedrab3\"=\"olivedrab3\",\"red1\"=\"red1\"), \n                       labels=c('KEGG network','pc-NEM'))\n  \n  \n  ggsave(\"~/Downloads/TypeIICompare.pdf\",width=6,height=4)\n  ",
    "created" : 1508238345035.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "4061261572",
    "id" : "E8AEEB7F",
    "lastKnownWriteTime" : 5432588413406543878,
    "last_content_update" : 1508397063646,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled32"
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}